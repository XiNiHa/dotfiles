#!/usr/bin/env nu

(
  hyprctl monitors -j
  | from json
  | where {|x| $x.focused}
  | first
  | get activeWorkspace
  | get id
  | print
)

def print_workspace [] {
  each {|s| (
    $s | lines | each {|l| (
    	$l
      | parse --regex '^workspace>>(?P<workspace>\d+)'
      | if ($in | length) != 0 { print $in.0.workspace }
    )}
  )} | ignore
}

socat -u $'unix-connect:($env.XDG_RUNTIME_DIR)/hypr/($env.HYPRLAND_INSTANCE_SIGNATURE)/.socket2.sock' - | print_workspace
